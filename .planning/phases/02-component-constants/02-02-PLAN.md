---
phase: 02-component-constants
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/constants/index.js
  - frontend/src/constants/thresholds.js
  - frontend/src/constants/structure.js
  - frontend/src/constants/ui.js
autonomous: true

must_haves:
  truths:
    - "Frontend has centralized constants module"
    - "Magic numbers extracted from utility files"
    - "All constants have JSDoc documentation"
    - "Existing functionality unchanged"
  artifacts:
    - path: "frontend/src/constants/index.js"
      provides: "Barrel file for constants"
      min_lines: 10
    - path: "frontend/src/constants/thresholds.js"
      provides: "Distance and size thresholds"
      exports: ["DISTANCE_CLOSE_THRESHOLD", "DISTANCE_MEDIUM_THRESHOLD"]
    - path: "frontend/src/constants/structure.js"
      provides: "PDB structure boundaries"
      exports: ["STRUCTURE_START", "STRUCTURE_END"]
  key_links:
    - from: "frontend/src/utils/dnaDistanceCalculator.js"
      to: "frontend/src/constants/structure.js"
      via: "import statement"
      pattern: "from '@/constants"
---

<objective>
Create centralized frontend constants module for HNF1B domain values.

Purpose: Extract hardcoded magic numbers from frontend utilities into documented constants for maintainability, reusability, and consistency with backend.

Output: `frontend/src/constants/` module with domain-specific constant files
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-component-constants/02-CONTEXT.md
@.planning/phases/02-component-constants/02-RESEARCH.md

# Existing config patterns to follow
@frontend/src/config/app.js
@frontend/src/utils/dnaDistanceCalculator.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create frontend constants module</name>
  <files>
frontend/src/constants/index.js
frontend/src/constants/thresholds.js
frontend/src/constants/structure.js
frontend/src/constants/ui.js
  </files>
  <action>
Create `frontend/src/constants/` directory with domain-specific files.

Follow the patterns from RESEARCH.md - use SCREAMING_SNAKE_CASE for true constants.

**Create `frontend/src/constants/thresholds.js`:**
```javascript
/**
 * Distance Thresholds for DNA Proximity Analysis
 */

/** Close distance threshold (Angstroms). Residues closer likely have direct DNA contact. */
export const DISTANCE_CLOSE_THRESHOLD = 5;

/** Medium distance threshold (Angstroms). Between close and medium may have indirect effects. */
export const DISTANCE_MEDIUM_THRESHOLD = 10;

/** Size threshold (bp) for CNV vs indel classification. */
export const STRUCTURAL_VARIANT_SIZE_THRESHOLD = 50;

/** Overlap threshold (amino acids) for variant label positioning. */
export const LABEL_OVERLAP_THRESHOLD = 30;
```

**Create `frontend/src/constants/structure.js`:**
```javascript
/**
 * PDB 2H8R Structure Constants
 * Maps to UniProt P35680 residues 90-308
 */

/** First residue visible in PDB 2H8R structure */
export const STRUCTURE_START = 90;

/** Last residue visible in PDB 2H8R structure */
export const STRUCTURE_END = 308;

/** Gap start - linker region not resolved in crystal */
export const STRUCTURE_GAP_START = 187;

/** Gap end */
export const STRUCTURE_GAP_END = 230;

/**
 * HNF1B Domain Boundaries (UniProt P35680)
 */
export const DOMAIN_BOUNDARIES = {
  dimerization: { start: 1, end: 31 },
  pou_specific: { start: 88, end: 173 },
  pou_homeodomain: { start: 232, end: 305 },
  transactivation: { start: 314, end: 557 },
};

/**
 * HNF1B Gene Coordinates (GRCh38)
 */
export const HNF1B_GENE = {
  chromosome: '17',
  start: 37686430,
  end: 37745059,
};
```

**Create `frontend/src/constants/ui.js`:**
```javascript
/**
 * UI Constants
 */

/** Maximum recent searches to store in history */
export const MAX_RECENT_SEARCHES = 5;

/** Cache TTL in milliseconds (5 minutes) */
export const CACHE_TTL_MS = 5 * 60 * 1000;

/** Default debounce delay (ms) for search inputs */
export const DEBOUNCE_DELAY_MS = 300;

/** Tooltip dimensions */
export const TOOLTIP = {
  MAX_WIDTH: 300,
  MAX_HEIGHT: 200,
  OFFSET_X: 15,
  OFFSET_Y: 10,
};
```

**Create `frontend/src/constants/index.js`:**
```javascript
/**
 * Centralized Constants Module
 *
 * For tree-shaking optimization, prefer direct imports:
 *   import { STRUCTURE_START } from '@/constants/structure';
 *
 * Barrel import available for convenience:
 *   import { STRUCTURE_START, DISTANCE_CLOSE_THRESHOLD } from '@/constants';
 */

export * from './thresholds';
export * from './structure';
export * from './ui';
```

Add JSDoc comments to every export explaining its purpose.
  </action>
  <verify>
Run: `cd /home/bernt-popp/development/hnf1b-db/frontend && node -e "import('./src/constants/index.js').then(m => console.log('Exports:', Object.keys(m).slice(0,5).join(', ') + '...'))"` - should list constants
  </verify>
  <done>
Constants module exists with all documented domain values, exports successfully
  </done>
</task>

<task type="auto">
  <name>Task 2: Update frontend files to use constants</name>
  <files>
frontend/src/utils/dnaDistanceCalculator.js
frontend/src/utils/searchHistory.js
frontend/src/stores/variantStore.js
  </files>
  <action>
Update frontend utility files to import and use constants from the new module.

**1. `utils/dnaDistanceCalculator.js`:**
Currently exports its own STRUCTURE_START, STRUCTURE_END, etc.
- Keep the exports for backward compatibility (re-export from constants)
- Import the values from `@/constants/structure`
- Update DISTANCE_THRESHOLDS to use imported constants

```javascript
// At top of file
import {
  STRUCTURE_START as _STRUCTURE_START,
  STRUCTURE_END as _STRUCTURE_END,
  STRUCTURE_GAP_START as _STRUCTURE_GAP_START,
  STRUCTURE_GAP_END as _STRUCTURE_GAP_END,
} from '@/constants/structure';
import { DISTANCE_CLOSE_THRESHOLD, DISTANCE_MEDIUM_THRESHOLD } from '@/constants/thresholds';

// Re-export for backward compatibility
export const STRUCTURE_START = _STRUCTURE_START;
export const STRUCTURE_END = _STRUCTURE_END;
export const STRUCTURE_GAP_START = _STRUCTURE_GAP_START;
export const STRUCTURE_GAP_END = _STRUCTURE_GAP_END;

// Update DISTANCE_THRESHOLDS to use constants
export const DISTANCE_THRESHOLDS = {
  CLOSE: DISTANCE_CLOSE_THRESHOLD,
  MEDIUM: DISTANCE_MEDIUM_THRESHOLD,
};
```

**2. `utils/searchHistory.js` (if exists):**
- Replace hardcoded 5 with MAX_RECENT_SEARCHES from `@/constants/ui`

**3. `stores/variantStore.js` (if exists):**
- Replace hardcoded cache TTL with CACHE_TTL_MS from `@/constants/ui`
- Replace HNF1B gene boundaries with import from `@/constants/structure`

Run `grep -r "37686430\|5 \* 60"` to find other files that may need updating.

Ensure no functionality changes - only source of values changes.
  </action>
  <verify>
Run: `cd /home/bernt-popp/development/hnf1b-db/frontend && npm run lint && npm test` - passes without errors
  </verify>
  <done>
Frontend files use constants from centralized module, tests pass
  </done>
</task>

</tasks>

<verification>
1. Constants module exists and is importable
2. `npm run lint` passes in frontend directory
3. `npm test` passes in frontend directory
4. No hardcoded magic numbers remain in modified files
5. dnaDistanceCalculator.js still exports same values (backward compatible)
</verification>

<success_criteria>
- [x] `frontend/src/constants/` module exists with documented constants
- [x] Frontend files import from constants module
- [x] Backward compatibility maintained for dnaDistanceCalculator exports
- [x] All frontend tests pass
- [x] No lint errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-component-constants/02-02-SUMMARY.md`
</output>
