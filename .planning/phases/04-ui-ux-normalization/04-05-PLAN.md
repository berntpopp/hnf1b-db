---
phase: 04-ui-ux-normalization
plan: 05
type: execute
wave: 2
depends_on:
  - 04-01
  - 04-02
files_modified:
  - frontend/src/views/PagePhenopacket.vue
  - frontend/src/views/PageVariant.vue
  - frontend/src/views/PagePublication.vue
  - frontend/src/views/Home.vue
autonomous: true

must_haves:
  truths:
    - "Detail views use PageHeader component with hero variant"
    - "Home page uses consistent design tokens for stat cards"
    - "Typography hierarchy is consistent across detail pages"
    - "Breadcrumbs use standard Vuetify pattern"
  artifacts:
    - path: "frontend/src/views/PagePhenopacket.vue"
      provides: "Phenopacket detail with PageHeader hero variant"
      contains: "PageHeader"
    - path: "frontend/src/views/PageVariant.vue"
      provides: "Variant detail with PageHeader hero variant"
      contains: "PageHeader"
    - path: "frontend/src/views/PagePublication.vue"
      provides: "Publication detail with PageHeader hero variant"
      contains: "PageHeader"
    - path: "frontend/src/views/Home.vue"
      provides: "Home page with design token colors"
      contains: "designTokens"
  key_links:
    - from: "frontend/src/views/PagePhenopacket.vue"
      to: "frontend/src/components/common/PageHeader.vue"
      via: "component import"
      pattern: "import PageHeader"
    - from: "frontend/src/views/Home.vue"
      to: "frontend/src/utils/designTokens.js"
      via: "color import"
      pattern: "import.*designTokens"
---

<objective>
Migrate detail views and Home page to use new design system components and tokens.

Purpose: Complete UI/UX normalization by applying PageHeader to detail pages (with hero variant) and updating Home page to use centralized design tokens.

Output: Updated PagePhenopacket.vue, PageVariant.vue, PagePublication.vue using PageHeader with hero variant; Home.vue using design tokens for consistent colors.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-ui-ux-normalization/04-CONTEXT.md
@.planning/phases/04-ui-ux-normalization/04-01-SUMMARY.md
@.planning/phases/04-ui-ux-normalization/04-02-SUMMARY.md
@frontend/src/views/PagePhenopacket.vue
@frontend/src/views/PageVariant.vue
@frontend/src/views/PagePublication.vue
@frontend/src/views/Home.vue
@frontend/src/components/common/PageHeader.vue
@frontend/src/utils/designTokens.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate PagePhenopacket.vue to PageHeader</name>
  <files>frontend/src/views/PagePhenopacket.vue</files>
  <action>
Update `frontend/src/views/PagePhenopacket.vue` to use PageHeader component:

1. **Add import:**
   ```javascript
   import PageHeader from '@/components/common/PageHeader.vue';
   ```

2. **Register component** in components object.

3. **Replace the custom hero section** with PageHeader:

   Current structure (remove this):
   ```vue
   <section class="hero-section py-2 px-4 mb-2">
     <v-container>
       <v-row justify="center" align="center">
         ...back button...
         ...breadcrumbs...
         ...icon...
         ...title "Individual Details"...
         ...chips...
       </v-row>
     </v-container>
   </section>
   ```

   Replace with:
   ```vue
   <PageHeader
     title="Individual Details"
     icon="mdi-account-details"
     :breadcrumbs="breadcrumbs"
     variant="hero"
     show-back
     @back="$router.back()"
   >
     <template #prepend>
       <!-- Loading skeleton -->
       <template v-if="loading">
         <v-skeleton-loader type="chip" width="80" class="ma-0" />
         <v-skeleton-loader type="chip" width="60" class="ma-0" />
       </template>
       <!-- Loaded: Inline Stats Chips -->
       <template v-else-if="phenopacket">
         <v-chip color="teal-lighten-4" size="small" variant="flat" class="font-weight-medium">
           {{ phenopacket.id }}
         </v-chip>
         <v-chip
           v-if="subjectSex"
           :color="getSexChipColor(subjectSex)"
           size="small"
           variant="flat"
         >
           <v-icon start size="x-small" aria-hidden="true">{{ getSexIcon(subjectSex) }}</v-icon>
           {{ formatSex(subjectSex) }}
         </v-chip>
         <v-chip
           v-if="ageDisplay !== 'N/A'"
           color="amber-lighten-4"
           size="small"
           variant="flat"
         >
           <v-icon start size="x-small" aria-hidden="true">mdi-calendar-clock</v-icon>
           {{ ageDisplay }}
         </v-chip>
         <v-chip color="green-lighten-4" size="small" variant="flat">
           <v-icon start size="x-small" aria-hidden="true">mdi-format-list-checks</v-icon>
           {{ phenotypicFeaturesCount }} HPO
         </v-chip>
         <v-chip v-if="variantsCount > 0" color="red-lighten-4" size="small" variant="flat">
           <v-icon start size="x-small" aria-hidden="true">mdi-dna</v-icon>
           {{ variantsCount }} Variant{{ variantsCount === 1 ? '' : 's' }}
         </v-chip>
       </template>
     </template>
   </PageHeader>
   ```

4. **Remove old hero-section styling** from scoped styles (keep if still needed elsewhere, but PageHeader has its own hero styles).

5. **Keep breadcrumbs computed property** but ensure format matches Vuetify breadcrumbs:
   ```javascript
   breadcrumbs() {
     return [
       { title: 'Home', to: '/' },
       { title: 'Phenopackets', to: '/phenopackets' },
       { title: this.phenopacket?.id || 'Loading...', disabled: true },
     ];
   },
   ```

6. **Verify sex utility imports** are present: getSexIcon, getSexChipColor, formatSex from '@/utils/sex'.
  </action>
  <verify>
    `grep "import PageHeader" frontend/src/views/PagePhenopacket.vue` returns match
    `grep "<PageHeader" frontend/src/views/PagePhenopacket.vue` returns match
    `grep 'variant="hero"' frontend/src/views/PagePhenopacket.vue` returns match
    `cd frontend && npm run build 2>&1 | head -20` compiles without errors
  </verify>
  <done>
    PagePhenopacket.vue uses PageHeader with hero variant and prepend slot for stats chips
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate PageVariant.vue and PagePublication.vue</name>
  <files>frontend/src/views/PageVariant.vue, frontend/src/views/PagePublication.vue</files>
  <action>
Update both detail views to use PageHeader component:

**PageVariant.vue:**

1. **Add import:**
   ```javascript
   import PageHeader from '@/components/common/PageHeader.vue';
   ```

2. **Register component.**

3. **Add PageHeader** (check current structure and adapt):
   ```vue
   <PageHeader
     title="Variant Details"
     icon="mdi-dna"
     icon-color="pink"
     :breadcrumbs="breadcrumbs"
     variant="hero"
     show-back
     @back="$router.back()"
   >
     <template #prepend>
       <v-chip v-if="variant" :color="getPathogenicityColor(variant.pathogenicity)" size="small" variant="flat">
         {{ variant.pathogenicity || 'Unknown' }}
       </v-chip>
       <v-chip v-if="variant?.hgvs_c" color="purple-lighten-4" size="small" variant="flat">
         {{ variant.hgvs_c }}
       </v-chip>
     </template>
   </PageHeader>
   ```

4. **Add breadcrumbs computed:**
   ```javascript
   breadcrumbs() {
     return [
       { title: 'Home', to: '/' },
       { title: 'Variants', to: '/variants' },
       { title: this.variant?.hgvs_c || 'Loading...', disabled: true },
     ];
   },
   ```

**PagePublication.vue:**

1. **Add import:**
   ```javascript
   import PageHeader from '@/components/common/PageHeader.vue';
   ```

2. **Register component.**

3. **Add PageHeader:**
   ```vue
   <PageHeader
     title="Publication Details"
     icon="mdi-file-document"
     icon-color="cyan-darken-1"
     :breadcrumbs="breadcrumbs"
     variant="hero"
     show-back
     @back="$router.back()"
   >
     <template #prepend>
       <v-chip v-if="publication?.year" color="orange-lighten-4" size="small" variant="flat">
         {{ publication.year }}
       </v-chip>
       <v-chip v-if="publication?.pmid" color="blue-lighten-4" size="small" variant="flat">
         PMID: {{ publication.pmid }}
       </v-chip>
     </template>
   </PageHeader>
   ```

4. **Add breadcrumbs computed:**
   ```javascript
   breadcrumbs() {
     return [
       { title: 'Home', to: '/' },
       { title: 'Publications', to: '/publications' },
       { title: this.publication?.pmid ? `PMID:${this.publication.pmid}` : 'Loading...', disabled: true },
     ];
   },
   ```

**For both:** Remove any existing custom hero section styling that PageHeader now handles.
  </action>
  <verify>
    `grep "import PageHeader" frontend/src/views/PageVariant.vue` returns match
    `grep "import PageHeader" frontend/src/views/PagePublication.vue` returns match
    `grep 'variant="hero"' frontend/src/views/PageVariant.vue` returns match
    `grep 'variant="hero"' frontend/src/views/PagePublication.vue` returns match
    `cd frontend && npm run build 2>&1 | head -20` compiles without errors
  </verify>
  <done>
    PageVariant.vue and PagePublication.vue use PageHeader with hero variant
  </done>
</task>

<task type="auto">
  <name>Task 3: Update Home.vue with design tokens</name>
  <files>frontend/src/views/Home.vue</files>
  <action>
Update `frontend/src/views/Home.vue` to use design tokens for color consistency:

1. **Add import:**
   ```javascript
   import { DATA_COLORS } from '@/utils/designTokens';
   ```

2. **Add to data or computed** for template access (if using Options API):
   ```javascript
   data() {
     return {
       // ... existing data
       dataColors: DATA_COLORS,
     };
   },
   ```

   Or if using computed:
   ```javascript
   computed: {
     dataColors() {
       return DATA_COLORS;
     },
   },
   ```

3. **Update stat card colors** to use semantic colors:

   Current (hardcoded):
   ```vue
   <v-icon color="teal" ...>mdi-account-group</v-icon>
   <div class="text-h4 font-weight-bold text-teal mb-0">
   ```

   Updated (using token Vuetify classes):
   - Individuals: Keep `color="teal"` (matches PHENOPACKET token)
   - Variants: Use `color="pink"` (matches VARIANT token - already correct)
   - Publications: Use `color="cyan-darken-1"` (keep or use orange-lighten-3 from PUBLICATION token)
   - Phenotypes: Use `color="green"` (matches PHENOTYPE token)

4. **Consider PageHeader for hero** (optional, Home is special):

   Home.vue has a unique hero with search bar, so keep the custom hero structure but ensure colors are consistent. The main page title should still be `<h1>`:

   ```vue
   <h1 class="text-h3 font-weight-bold text-teal-darken-2 mb-2">HNF1B Database</h1>
   ```

   This is semantic HTML already - no change needed.

5. **Verify card styles** use Vuetify defaults (elevation="2", rounded="lg" from vuetify.js defaults).

6. **Color cleanup:** Remove any hardcoded hex colors in template, use Vuetify color classes that map to design tokens.

**Note:** Home.vue is a landing page with different structure than list/detail views. Focus on color consistency rather than full component replacement.
  </action>
  <verify>
    `grep "import.*designTokens" frontend/src/views/Home.vue` returns match
    `grep "DATA_COLORS" frontend/src/views/Home.vue` returns match
    `cd frontend && npm run build 2>&1 | head -20` compiles without errors
  </verify>
  <done>
    Home.vue imports and uses design tokens for consistent stat card colors
  </done>
</task>

</tasks>

<verification>
1. All three detail views use PageHeader with hero variant
2. All detail views have proper breadcrumb navigation
3. Home.vue uses design token colors for stat cards
4. Semantic HTML preserved (h1 for titles)
5. Build passes: `cd frontend && npm run build`
6. Tests pass: `cd frontend && npm test`
7. Visual check: Hero sections render consistently, colors match design tokens
</verification>

<success_criteria>
- PagePhenopacket.vue uses PageHeader with hero variant, back button, and prepend slot for chips
- PageVariant.vue uses PageHeader with hero variant and pathogenicity chip
- PagePublication.vue uses PageHeader with hero variant and year/PMID chips
- Home.vue imports DATA_COLORS from designTokens.js
- All detail pages have consistent breadcrumb structure
- Build passes, tests pass
- Colors are consistent with design token definitions
</success_criteria>

<output>
After completion, create `.planning/phases/04-ui-ux-normalization/04-05-SUMMARY.md`
</output>
