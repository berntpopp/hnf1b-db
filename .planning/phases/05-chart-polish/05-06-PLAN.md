---
phase: 05-chart-polish
plan: 06
type: execute
wave: 3
depends_on: ["05-02", "05-03", "05-04", "05-05"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "All chart components have working animations"
    - "All chart exports produce valid files"
    - "Reduced motion is respected across all charts"
    - "Screen reader descriptions are meaningful"
  artifacts: []
  key_links: []
---

<objective>
Verify all chart enhancements work correctly through manual testing and screen reader validation.

Purpose: Ensure Phase 5 requirements are fully met before marking complete.
Output: Human verification of all chart behaviors, documented issues resolved.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/05-chart-polish/05-CONTEXT.md
@.planning/phases/05-chart-polish/05-02-SUMMARY.md
@.planning/phases/05-chart-polish/05-03-SUMMARY.md
@.planning/phases/05-chart-polish/05-04-SUMMARY.md
@.planning/phases/05-chart-polish/05-05-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
All chart components (DonutChart, StackedBarChart, KaplanMeierChart, VariantComparisonChart, BoxPlotChart) now have:
- ARIA accessibility attributes (role="img", aria-labelledby, title, desc elements)
- Entry animations with staggered timing
- Export menu with PNG and CSV options
- Support for prefers-reduced-motion
  </what-built>
  <how-to-verify>
1. Start the development server:
   ```bash
   cd /home/bernt-popp/development/hnf1b-db && make frontend
   ```

2. **Animation verification** - For each chart:
   a. Navigate to page containing chart (see URLs below)
   b. Refresh page and observe animation
   c. Verify animation is smooth and staggered

   Chart locations:
   - DonutChart: http://localhost:5173/aggregations (Demographics tab)
   - StackedBarChart: http://localhost:5173/aggregations (Phenotypes tab)
   - KaplanMeierChart: http://localhost:5173/aggregations (Survival tab)
   - VariantComparisonChart: http://localhost:5173/aggregations (Comparisons tab)
   - BoxPlotChart: http://localhost:5173/dna-distance (DNA Distance Analysis page)

3. **Reduced motion verification**:
   a. Enable reduced motion in system settings:
      - macOS: System Preferences > Accessibility > Display > Reduce motion
      - Linux (GNOME): Settings > Accessibility > Reduce animation
      - Windows: Settings > Ease of Access > Display > Show animations
   b. Refresh each chart page
   c. Verify charts appear instantly without animation

4. **Export verification** - For each chart:
   a. Click Export dropdown menu
   b. Click "Download PNG" - verify PNG file downloads with white background
   c. Click "Download CSV" - verify CSV file downloads with correct headers
   d. Open downloaded files and verify content is correct

5. **Accessibility verification** (optional but recommended):
   a. Open browser DevTools
   b. Inspect SVG element
   c. Verify: role="img", aria-labelledby attribute present
   d. Verify: <title> and <desc> elements inside SVG
   e. (Optional) Test with screen reader (VoiceOver/NVDA) - chart should read description

6. **Report any issues found**
  </how-to-verify>
  <resume-signal>
Type "approved" if all verifications pass.
Or describe issues found (e.g., "DonutChart animation stutters", "CSV missing headers").
  </resume-signal>
</task>

<task type="auto">
  <name>Task 2: Run full test suite</name>
  <files></files>
  <action>
Run the complete frontend test suite to ensure no regressions:

```bash
cd /home/bernt-popp/development/hnf1b-db/frontend && npm test -- --run
```

If any tests fail, investigate and fix before proceeding.

Also run lint check:
```bash
cd /home/bernt-popp/development/hnf1b-db/frontend && npm run lint
```
  </action>
  <verify>All tests pass, no lint errors</verify>
  <done>Full frontend test suite passes. No regressions from Phase 5 changes.</done>
</task>

<task type="auto">
  <name>Task 3: Final cleanup and commit</name>
  <files></files>
  <action>
1. Ensure all Phase 5 changes are staged:
   ```bash
   git status
   git add frontend/src/utils/export.js
   git add frontend/src/utils/chartAccessibility.js
   git add frontend/src/utils/chartAnimation.js
   git add frontend/src/components/common/ChartExportMenu.vue
   git add frontend/src/components/analyses/DonutChart.vue
   git add frontend/src/components/analyses/StackedBarChart.vue
   git add frontend/src/components/analyses/KaplanMeierChart.vue
   git add frontend/src/components/analyses/VariantComparisonChart.vue
   git add frontend/src/components/analyses/BoxPlotChart.vue
   git add frontend/tests/
   ```

2. Create final commit for Phase 5 if not already committed in individual plan executions:
   ```bash
   git status  # Check if there are uncommitted changes
   ```

3. Update STATE.md to reflect Phase 5 completion
  </action>
  <verify>git log shows Phase 5 commits, STATE.md updated</verify>
  <done>Phase 5 complete, all changes committed, STATE.md updated.</done>
</task>

</tasks>

<verification>
All chart enhancements verified through:
1. Manual animation testing on each chart
2. Reduced motion preference testing
3. Export file verification (PNG and CSV)
4. Accessibility attribute inspection
5. Full test suite passing
</verification>

<success_criteria>
- [ ] Human verified: All charts animate correctly
- [ ] Human verified: Reduced motion disables animations
- [ ] Human verified: PNG exports work with white background
- [ ] Human verified: CSV exports work with correct headers
- [ ] Human verified: Accessibility attributes present
- [ ] Full frontend test suite passes
- [ ] No lint errors
- [ ] STATE.md updated to reflect Phase 5 complete
</success_criteria>

<output>
After completion, create `.planning/phases/05-chart-polish/05-06-SUMMARY.md`
</output>
